<!DOCTYPE html>
<html>

<head>
    <script src="./three.js-dev/build/three.min.js"></script>
</head>

<body onload="startThreeJS()">
    <script>
       var start; // Zmienna do przechowywania czasu startowego

function startThreeJS() {
    start = performance.now(); // Rozpoczynamy pomiar czasu
    var scene = new THREE.Scene();
    var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    var renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    var geometry = new THREE.BoxGeometry();
    var material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
    
    var cubes = [];
    for (let i = 0; i <= 10; i++) {
        var cube = new THREE.Mesh(geometry, material);
        cube.position.set(i, 0, 0); // Ustawianie różnych początkowych pozycji
        scene.add(cube);
        cubes.push(cube);
    }

    camera.position.z = 5;

    var totalDuration = 2000; // Animacja trwa 2 sekundy
    var targetPositionX = 2.5;
    var initialTime = null;

    function animate(timestamp) {
        if (!initialTime) initialTime = timestamp;

        var elapsed = timestamp - initialTime;
        var progress = Math.min(elapsed / totalDuration, 1);

        cubes.forEach((cube, index) => {
            cube.position.x = progress * (targetPositionX + index); // Animowanie każdego sześcianu
        });

        renderer.render(scene, camera);

        if (elapsed < totalDuration) {
            requestAnimationFrame(animate);
        } else {
            var end = performance.now();
            console.log('Total Time:', end - start, 'ms');
            sendDataToPHP(end - start);
        }
    }

    requestAnimationFrame(animate);
}

function sendDataToPHP(duration) {
    fetch('save_data.php', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ time: duration })
    })
        .then(response => response.text())
        .then(data => {
            console.log('Success:', data);
        })
        .catch((error) => {
            console.error('Error:', error);
        });
}
</script>
</body>

</html>