<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <title>Test Wydajności CanvasJS</title>
    <script src="canvasjs-chart-3.7.27/canvasjs.min.js"></script>
</head>

<body>

    <div id="chartContainer" style="height: 370px; width: 100%;"></div>
    <button id="btn10">10 zmiennych</button>
    <button id="btn100">100 zmiennych</button>
    <button id="btn1000">1000 zmiennych</button>
    <button id="btn10000">10000 zmiennych</button>
    <button id="btn100000">100000 zmiennych</button>

    <script>
        function generateData(count) {
            var dataPoints = [];
            for (var i = 0; i < count; i++) {
                dataPoints.push({ x: Math.random() * 1000, y: Math.random() * 1000, z: Math.random() * 1000 });
            }
            return dataPoints;
        }

        function renderChart(dataPoints, count) {
            const startTime = performance.now();

            var chart = new CanvasJS.Chart("chartContainer", {
                animationEnabled: true,
                theme: "light2",
                title: {
                    text: "Wykres Bąbelkowy"
                },
                axisX: {
                    title: "X"
                },
                axisY: {
                    title: "Y"
                },
                data: [{
                    type: "bubble",
                    showInLegend: true,
                    legendText: "Rozmiar bąbelka reprezentuje wartość Z",
                    dataPoints: dataPoints
                }]
            });
            chart.render();

            const endTime = performance.now();
            console.log(`Czas renderowania wykresu: ${endTime - startTime} ms`);

            let timee=endTime - startTime
            fetch('save_data.php', {
                method: 'POST',
                body: JSON.stringify({ data: dataPoints, count, timee }),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(response => response.text())
                .then(text => console.log(text))
                .catch(error => console.error('Błąd:', error));


        }

        document.getElementById('btn10').addEventListener('click', () => renderChart(generateData(10), 10));
        document.getElementById('btn100').addEventListener('click', () => renderChart(generateData(100), 100));
        document.getElementById('btn1000').addEventListener('click', () => renderChart(generateData(1000), 1000));
        document.getElementById('btn10000').addEventListener('click', () => renderChart(generateData(10000), 10000));
        document.getElementById('btn100000').addEventListener('click', () => renderChart(generateData(100000), 100000));
    </script>

</body>

</html>