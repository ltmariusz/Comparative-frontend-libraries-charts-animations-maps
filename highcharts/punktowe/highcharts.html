<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <title>Test Wydajności Highcharts - Wykres Punktowy</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
</head>

<body>

    <div id="container" style="width: 100%; height: 400px; margin: 0 auto"></div>
    <button id="btn10">10 punktów</button>
    <button id="btn100">100 punktów</button>
    <button id="btn1000">1000 punktów</button>
    <button id="btn10000">10000 punktów</button>
    <button id="btn100000">100000 punktów</button>

    <script>
        function generateData(count) {
            var dataPoints = [];
            for (var i = 0; i < count; i++) {
                dataPoints.push([Math.random() * 100, Math.random() * 100]);
            }
            return dataPoints;
        }

        function renderChart(dataPoints, count) {
            const startTime = performance.now(); // Rozpoczęcie pomiaru czasu

            Highcharts.chart('container', {
                chart: {
                    type: 'scatter',
                    zoomType: 'xy',
                    animation: false, // Wyłączenie animacji
                    events: {
                        load: function () {
                            const endTime = performance.now();
                            let timee = endTime - startTime;
                            console.log(timee)
                            fetch('save_data.php', {
                                method: 'POST',
                                body: JSON.stringify({ data: dataPoints, count, timee }),
                                headers: {
                                    'Content-Type': 'application/json'
                                }
                            })
                                .then(response => response.text())
                                .then(text => console.log(text))
                                .catch(error => console.error('Błąd:', error));
                        }
                    }
                
                },
                title: {
                    text: 'Losowe dane punktowe'
                },
                xAxis: {
                    title: {
                        enabled: true,
                        text: 'Oś X'
                    },
                    startOnTick: true,
                    endOnTick: true,
                    showLastLabel: true
                },
                yAxis: {
                    title: {
                        text: 'Oś Y'
                    }
                },
                legend: {
                    layout: 'vertical',
                    align: 'left',
                    verticalAlign: 'top',
                    x: 100,
                    y: 70,
                    floating: true,
                    backgroundColor: Highcharts.defaultOptions.chart.backgroundColor,
                    borderWidth: 1
                },
                plotOptions: {
                    scatter: {
                        animation: false, // Wyłączenie animacji dla serii danych
                        marker: {
                            radius: 5,
                            states: {
                                hover: {
                                    enabled: true,
                                    lineColor: 'rgb(100,100,100)'
                                }
                            }
                        },
                        states: {
                            hover: {
                                marker: {
                                    enabled: false
                                }
                            }
                        },
                        tooltip: {
                            headerFormat: '<b>{series.name}</b><br>',
                            pointFormat: '{point.x} cm, {point.y} kg'
                        }
                    }
                },
                series: [{
                    name: 'Losowe dane',
                    color: 'rgba(223, 83, 83, .5)',
                    data: dataPoints
                }],
                credits: {
                    enabled: false
                }
            });


        }

        // document.getElementById('btn10').addEventListener('click', function() {
        //     const startTime = performance.now(); // Rozpoczęcie pomiaru czasu
        //     const data = generateData(10);
        //     renderChart(data);
        //     console.log(`Czas renderowania wykresu: ${performance.now() - startTime} ms`);
        // });

        // document.getElementById('btn100').addEventListener('click', function() {
        //     const startTime = performance.now();
        //     const data = generateData(100);
        //     renderChart(data);
        //     console.log(`Czas renderowania wykresu: ${performance.now() - startTime} ms`);
        // });
        // document.getElementById('btn1000').addEventListener('click', function() {
        //     const startTime = performance.now();
        //     const data = generateData(1000);
        //     renderChart(data);
        //     console.log(`Czas renderowania wykresu: ${performance.now() - startTime} ms`);
        // });
        // document.getElementById('btn10000').addEventListener('click', function() {
        //     const startTime = performance.now();
        //     const data = generateData(10000);
        //     renderChart(data);
        //     console.log(`Czas renderowania wykresu: ${performance.now() - startTime} ms`);
        // });

        document.getElementById('btn10').addEventListener('click', () => renderChart(generateData(10), 10));
        document.getElementById('btn100').addEventListener('click', () => renderChart(generateData(100), 100));
        document.getElementById('btn1000').addEventListener('click', () => renderChart(generateData(1000), 1000));
        document.getElementById('btn10000').addEventListener('click', () => renderChart(generateData(10000), 10000));
        document.getElementById('btn100000').addEventListener('click', () => renderChart(generateData(100000), 100000));

    </script>

</body>

</html>