<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <title>Test Wydajności D3.js</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <style>

    </style>
</head>

<body>

    <svg width="400" height="200"></svg>
    <button id="btn10">10 zmiennych</button>
    <button id="btn100">100 zmiennych</button>
    <button id="btn1000">1000 zmiennych</button>
    <button id="btn10000">10000 zmiennych</button>

    <script>
           const svg = d3.select("svg");
    const margin = {top: 20, right: 20, bottom: 30, left: 40};
    const width = svg.node().getBoundingClientRect().width - margin.left - margin.right;
    const height = +svg.attr("height") - margin.top - margin.bottom;
    const g = svg.append("g").attr("transform", `translate(${margin.left},${margin.top})`);

    const xScale = d3.scaleLinear().range([0, width]);
    const yScale = d3.scaleLinear().range([height, 0]);


        function generateData(count) {
            return Array.from({ length: count }, () => ({ x: Math.random() * 100, y: Math.random() * 100 }));
        }
        function renderChart(data) {
        g.selectAll("*").remove(); // Usuń poprzednie elementy

        xScale.domain(d3.extent(data, d => d.x));
        yScale.domain(d3.extent(data, d => d.y));

        g.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(xScale));

        g.append("g")
            .call(d3.axisLeft(yScale));

        const startTime = performance.now(); // Rozpoczęcie pomiaru czasu

        g.selectAll(".dot")
            .data(data)
            .enter().append("circle")
            .attr("class", "dot")
            .attr("cx", d => xScale(d.x))
            .attr("cy", d => yScale(d.y))
            .attr("r", 5)
            .attr("fill", "blue");

        const endTime = performance.now(); // Zakończenie pomiaru czasu
        console.log(`Czas renderowania wykresu: ${endTime - startTime} ms`);


        fetch('save_data.php', {
            method: 'POST',
            body: JSON.stringify({ endTime: endTime }),
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.text())
            .then(text => console.log(text))
            .catch(error => console.error('Błąd:', error));
}

        document.getElementById('btn10').addEventListener('click', function () {
            const startTime = performance.now(); // Rozpoczęcie pomiaru czasu
            const data = generateData(10);
            renderChart(data);
            console.log(`Czas renderowania wykresu: ${performance.now() - startTime} ms`);
        });

        document.getElementById('btn100').addEventListener('click', function () {
            const startTime = performance.now();
            const data = generateData(100);
            renderChart(data);
            console.log(`Czas renderowania wykresu: ${performance.now() - startTime} ms`);
        });
        document.getElementById('btn1000').addEventListener('click', function () {
            const startTime = performance.now();
            const data = generateData(1000);
            renderChart(data);
            console.log(`Czas renderowania wykresu: ${performance.now() - startTime} ms`);
        });
        document.getElementById('btn10000').addEventListener('click', function () {
            const startTime = performance.now();
            const data = generateData(10000);
            renderChart(data);
            console.log(`Czas renderowania wykresu: ${performance.now() - startTime} ms`);
        });

    </script>

</body>

</html>